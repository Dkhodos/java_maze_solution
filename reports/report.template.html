<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        html {
            height: 100%;
        }

        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
        }

        h1{
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .maze-node {
            height: 5px;
            width: 5px;
            border: 1px solid black;

            display: flex;
            justify-content:center;
            align-items: center;
            transition: .2s all ease-in-out;
        }

        .maze-node.start {
            background: green;
        }

        .maze-node.end {
            background: red;
        }

        .maze-node.solution {
            background: aqua;
        }


        .maze-node.blocked {
            background: black;
        }

         .maze {
            display: grid;
        }
    </style>
</head>
<body>
<div id="root">
    <h1>Maze Report</h1>
</div>
<script>
    var maze = JSON.parse(`{{maze}}`);
    var solution = JSON.parse(`{{solution}}`);
    var start = JSON.parse(`{{start}}`);
    var end = JSON.parse(`{{end}}`);
    var visitedNodes = {{visitedNodes}};
</script>
<script>
(async () => {
    function drawMaze(){
        const mazeElement = document.createElement('div');
        mazeElement.className = "maze";

        for (let i = 0; i < maze.length; i++) {
            for (let j = 0; j < maze[0].length; j++) {
                mazeElement.appendChild(drawCell(maze[i][j]));
            }
        }

        mazeElement.style = `grid-template-columns: repeat(${maze.length}, 1fr);`

        document.getElementById("root").appendChild(mazeElement);
    }

    function drawCell(node){
        const nodeElement = document.createElement('div');
        nodeElement.className = "maze-node";

        nodeElement.dataset.x = node.x;
        nodeElement.dataset.y = node.y;

        if(node.isObstacle) nodeElement.classList.add("blocked");

        if (node.x === start.x && node.y === start.y){
            nodeElement.classList.add("start");
            nodeElement.innerHTML = "S";
        }

        if (node.x === end.x && node.y === end.y){
            nodeElement.classList.add("end");
            nodeElement.innerHTML = "E";
        }

        return nodeElement;
    }

    function drawSolution(){
        let delay = 300;
        for (const node of solution){
            const nodeElement = document.querySelector(`.maze-node[data-x="${node.x}"][data-y="${node.y}"]`);
            if(nodeElement){
                window.setTimeout(() => {
                   nodeElement.classList.add("solution");
                },delay);
                delay += 300;
            }
        }
    }

    function addCounts(){
        const countsElement = document.createElement('div');
        countsElement.className = "counts";

        countsElement.innerHTML += `<p><strong>Path Length:</strong> ${solution.length}</p>`;
        countsElement.innerHTML += `<p><strong>Visited Nodes Count:</strong> ${visitedNodes}</p>`;

        document.getElementById("root").appendChild(countsElement);
    }

    drawMaze();
    addCounts();
    drawSolution();
})();
</script>
</body>
</html>